#!/bin/bash


URL=""
COOKIE=""
OUTPUT=""

function parse_args() {
	# GNU getopt
	OPTIONS=$(getopt -o c:o: -l cookie:,output: -- "$@")

	eval set -- $OPTIONS
	while true; do
		case "$1" in
			-c | --cookie ) shift; COOKIE="$1" ;;
			-o | --output ) shift; OUTPUT="$1" ;;
			-- ) shift; URL="$1"; break ;;
			* ) break ;;
		esac
		shift
	done
}

function assert_args() {
	OK=true
	
	if [ "$URL" = "" ]; then
		echo "No url specified."
		OK=false
	fi

	if [ "$COOKIE" = "" ]; then
		echo "No cookie specified."
		OK=false
	fi

	if [ "$OUTPUT" = "" ]; then
		echo "No output directory specified."
		OK=false
	fi

	if [ "$OK" = false ]; then
		usage
	fi
}

function usage() {
	echo "Usage: ./lms-get <url> --cookie <sessionid> --output <dirname>"
	exit 1
}

parse_args $@
assert_args

echo $URL
echo $COOKIE
echo $OUTPUT
